import telebot
from telebot import types
import sqlite3

 
token = "6968907461:AAG5j6gXd2B5WAsCL6jDC8_85I4YzskXUKg"
def user(message):    #–ø–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if message.from_user.last_name == None:
        return message.from_user.first_name
    return f"{message.from_user.first_name} {message.from_user.last_name}"
bot = telebot.TeleBot(token)


@bot.message_handler(commands=['start'])    #–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start - —Å–æ–æ –æ—Ç –±–æ—Ç–∞
def start_message(message):

    conn = sqlite3.connect('tbdatabase.sql')    #—Å–æ–∑–¥–∞–Ω–∏–µ –±–¥/–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–¥, –∑–∞–ø–∏—Å—ã–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç
    cur = conn.cursor()
    cur.execute('CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, name varchar(50))')
    cur.execute('INSERT INTO users (name) VALUES ("%s")' % (user(message)))
    conn.commit()
    cur.close()
    conn.close()

    bot.send_message(message.chat.id, f"<i>–ü—Ä–∏–≤–µ—Ç, {user(message)}!</i>"
                                      "\n\n–° —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è —Ç—ã —Å—Ç–∞–Ω–µ—à—å —á–∞—Å—Ç—å—é –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–≥–æ –Ω–∞—É—á–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞, "
                                      "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ –∫–æ—Ç–æ—Ä–æ–º, –≤–ø—Ä–æ—á–µ–º, —É–∑–Ω–∞–µ—à—å –Ω–µ–º–Ω–æ–≥–æ –ø–æ–∑–∂–µ üß™ "
                                      "–¢–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Ä–µ—à–∏—Ç—å —Å—É–¥—å–±—É –≤—Å–µ–≥–æ‚Ä¶ <tg-spoiler>–ª–∏—à—å –æ–¥–Ω–æ–≥–æ –Ω–µ–±–æ–ª—å—à–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–∞, –∑–∞—Ç–æ –∫–∞–∫–æ–≥–æ</tg-spoiler>! "
                                      "–°–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ —Ç—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏—à—å—Å—è —Å –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –∏ —Ç–æ–Ω–∫–æ—Å—Ç—è–º–∏ —Ç–∞–∫–æ–≥–æ –Ω–µ–ø—Ä–æ—Å—Ç–æ–≥–æ –¥–µ–ª–∞, "
                                      "–∞ –ø–æ–∫–∞ ‚Äî welcome to <b>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</b>! ü´ß"
                                      "\n\n–ù–∞–±–æ—Ä <s>—Ö–∏–º–∏–∫–∞—Ç–æ–≤</s> –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:"
                                      "\n\n/newgame - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –∏–≥—Ä–æ–≤–∞—è —Å–µ—Å—Å–∏—è"
                                      "\n‚ùóÔ∏è –≤–∞–∂–Ω–æ: –µ—Å–ª–∏ –∏–≥—Ä–æ–≤–∞—è —Å–µ—Å—Å–∏—è —É–∂–µ –Ω–∞—á–∞—Ç–∞, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±–Ω—É–ª–∏—Ç—Å—è ‚ùóÔ∏è"
                                      "\n/start - –ø–æ—è–≤–∏—Ç—Å—è —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ —Ç—ã —á–∏—Ç–∞–µ—à—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å üëÄ"
                                      "\n/contact - —á–µ—Ä–µ–∑ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞–º, —Å–æ–∑–¥–∞—Ç–µ–ª—è–º –∏–≥—Ä—ã! –ú—ã –≤—Å–µ–≥–¥–∞ –∂–¥–µ–º –æ—Ç–∑—ã–≤–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π ü§ç"
                                      "\n\n<i>–ò –ø–æ–º–Ω–∏: –∫–∞–∂–¥–æ–µ —Ç–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–º–µ–µ—Ç –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è‚Ä¶</i>", parse_mode="HTML")


@bot.message_handler(commands=['newgame'])    #–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /newgame - —Å–æ–æ –æ—Ç –±–æ—Ç–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏
def newgame_message(message):
    markup = types.InlineKeyboardMarkup()    #—Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Å–æ–æ
    button1 = types.InlineKeyboardButton(text='–∫–Ω–æ–ø–∫–∞ —Ä–∞—Å', callback_data='knopochka1')
    button2 = types.InlineKeyboardButton(text='–∫–Ω–æ–ø–∫–∞ –¥–≤–∞', callback_data='knopochka2')
    markup.row(button1, button2)

    photo = open('C:/question.jpg', 'rb')    #—Å–∞–º –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /newgame
    bot.send_photo(message.chat.id, photo)
    bot.send_message(message.chat.id, '*—Ç—É—Ç –±—ã–ª–æ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –ª–µ–Ω–æ–π –Ω–æ —è –µ–≥–æ —Å–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª–∏–ª–∞. –ü–æ—Ç–æ–º –≤–µ—Ä–Ω—É*', reply_markup=markup) #–≤–µ—Ä–Ω—É—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏!!!!!!
    audio = open('C:/whatsthat.mp3', 'rb')
    bot.send_audio(message.chat.id, audio)


@bot.message_handler(commands=['ab'])    #–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /ab - —Å–æ–æ –æ—Ç –±–æ—Ç–∞
def ab_message(message):
    bot.send_message(message.chat.id, message)    #–ø–æ—Ç–æ–º —É–¥–∞–ª–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É


@bot.message_handler(commands=['contact'])     #–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /contact - —Å–æ–æ –æ—Ç –±–æ—Ç–∞ + –ø–µ—Ä–µ—Å—ã–ª–∫–∞ —Å–æ–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è–º
def contact_message(message):
    bot.send_message(message.chat.id, "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–∞—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏, –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –∏—Ö! (—Å–ª–µ–¥—É—é—â–µ–µ –≤–∞—à–µ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–¥–Ω–æ–º—É –∏–∑ –∫–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π)")
    @bot.message_handler(content_types=['text'])
    def get_text_messages(message):
        bot.send_message(message.from_user.id, '–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ!')
        bot.send_message(416671069, f'{message.text}, –æ—Ç {user(message)}; ID: {message.from_user.id}')


@bot.message_handler(commands=['database_info'])    #–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /users - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
def database_info_message(message):
    markup = types.InlineKeyboardMarkup()    #—Å–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –Ω–∞ —Å–æ–æ
    button = types.InlineKeyboardButton(text='–í—ã–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', callback_data='users')
    markup.row(button)
    bot.send_message(message.chat.id, '–ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å?', reply_markup=markup)


@bot.callback_query_handler(func=lambda callback: True)    #–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–Ω–æ–ø–æ–∫: –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Å–æ–æ –ø–æ—Å–ª–µ /newgame –∏ –≤ —Å–æ–æ –ø–æ—Å–ª–µ /database_info
def buttons_callback(callback):
    if callback.data == 'knopochka1':
        bot.send_message(callback.message.chat.id, '–≤—ã –≥–µ–Ω–∏–π')
    if callback.data == 'knopochka2':
        bot.send_message(callback.message.chat.id, '–≤—ã –¥—É—Ä–∞—á–æ–∫')
    if callback.data == 'users':
        conn = sqlite3.connect('tbdatabase.sql')
        cur = conn.cursor()
        cur.execute('SELECT * FROM users')   #–≤—Å—è –∏–Ω—Ñ–∞ –∏–∑ —Ç–∞–±–ª–∏—á–∫–∏ users
        users = cur.fetchall()
        
        info = ''
        for element in users:    #–≤—ã–≤–æ–¥–∏–º –∏–º–µ–Ω–∞
            info += f'{element [0]}, {element[1]}\n'

        bot.send_message(callback.message.chat.id, info)

        cur.close()
        conn.close()

bot.infinity_polling()